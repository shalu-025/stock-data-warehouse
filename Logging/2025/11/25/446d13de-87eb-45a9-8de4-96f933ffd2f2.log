
********** Local Data Warehouse and Analytical Reporting System **********
Filename: Stock Market and Macroeconomic Intelligence
User ID: 800338
Username: Shalini Tata
File Path: /Users/shalinitata/Desktop/stocks/watcher.py
********** Stock Market and Macroeconomic Intelligence **********
2025-11-25 04:09:04,419 - INFO - ===== started running the process ======
2025-11-25 04:09:04,504 - INFO - ============================================================
2025-11-25 04:09:04,504 - INFO - Starting merge process
2025-11-25 04:09:04,504 - INFO - Mode: Historical
2025-11-25 04:09:04,504 - INFO - Date range: 2024-11-01 to 2024-12-31
2025-11-25 04:09:04,504 - INFO - Execution dir: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04
2025-11-25 04:09:04,504 - INFO - 
============================================================
2025-11-25 04:09:04,504 - INFO - Processing BASE TABLE (stocks_raw)
2025-11-25 04:09:04,505 - INFO - Processing stocks_raw (BASE TABLE)
2025-11-25 04:09:04,507 - INFO - Read 92 rows from 2024/11/04/stocks.csv
2025-11-25 04:09:04,508 - INFO - Read 92 rows from 2024/11/05/stocks.csv
2025-11-25 04:09:04,508 - INFO - Read 91 rows from 2024/11/20/stocks.csv
2025-11-25 04:09:04,509 - INFO - Read 92 rows from 2024/11/18/stocks.csv
2025-11-25 04:09:04,509 - INFO - Read 92 rows from 2024/11/27/stocks.csv
2025-11-25 04:09:04,509 - INFO - Read 92 rows from 2024/11/11/stocks.csv
2025-11-25 04:09:04,510 - INFO - Read 92 rows from 2024/11/29/stocks.csv
2025-11-25 04:09:04,510 - INFO - Read 7 rows from 2024/11/28/stocks.csv
2025-11-25 04:09:04,511 - INFO - Read 92 rows from 2024/11/19/stocks.csv
2025-11-25 04:09:04,511 - INFO - Read 92 rows from 2024/11/26/stocks.csv
2025-11-25 04:09:04,512 - INFO - Read 92 rows from 2024/11/21/stocks.csv
2025-11-25 04:09:04,512 - INFO - Read 92 rows from 2024/11/07/stocks.csv
2025-11-25 04:09:04,513 - INFO - Read 92 rows from 2024/11/08/stocks.csv
2025-11-25 04:09:04,513 - INFO - Read 92 rows from 2024/11/01/stocks.csv
2025-11-25 04:09:04,513 - INFO - Read 92 rows from 2024/11/06/stocks.csv
2025-11-25 04:09:04,514 - INFO - Read 91 rows from 2024/11/15/stocks.csv
2025-11-25 04:09:04,514 - INFO - Read 92 rows from 2024/11/12/stocks.csv
2025-11-25 04:09:04,515 - INFO - Read 92 rows from 2024/11/13/stocks.csv
2025-11-25 04:09:04,515 - INFO - Read 92 rows from 2024/11/14/stocks.csv
2025-11-25 04:09:04,516 - INFO - Read 92 rows from 2024/11/22/stocks.csv
2025-11-25 04:09:04,516 - INFO - Read 92 rows from 2024/11/25/stocks.csv
2025-11-25 04:09:04,517 - INFO - Read 93 rows from 2024/12/03/stocks.csv
2025-11-25 04:09:04,517 - INFO - Read 93 rows from 2024/12/04/stocks.csv
2025-11-25 04:09:04,517 - INFO - Read 93 rows from 2024/12/05/stocks.csv
2025-11-25 04:09:04,518 - INFO - Read 92 rows from 2024/12/02/stocks.csv
2025-11-25 04:09:04,518 - INFO - Read 92 rows from 2024/12/20/stocks.csv
2025-11-25 04:09:04,518 - INFO - Read 93 rows from 2024/12/18/stocks.csv
2025-11-25 04:09:04,519 - INFO - Read 93 rows from 2024/12/27/stocks.csv
2025-11-25 04:09:04,519 - INFO - Read 92 rows from 2024/12/11/stocks.csv
2025-11-25 04:09:04,519 - INFO - Read 93 rows from 2024/12/16/stocks.csv
2025-11-25 04:09:04,520 - INFO - Read 93 rows from 2024/12/17/stocks.csv
2025-11-25 04:09:04,520 - INFO - Read 93 rows from 2024/12/10/stocks.csv
2025-11-25 04:09:04,520 - INFO - Read 93 rows from 2024/12/19/stocks.csv
2025-11-25 04:09:04,521 - INFO - Read 87 rows from 2024/12/26/stocks.csv
2025-11-25 04:09:04,521 - INFO - Read 93 rows from 2024/12/09/stocks.csv
2025-11-25 04:09:04,521 - INFO - Read 93 rows from 2024/12/30/stocks.csv
2025-11-25 04:09:04,522 - INFO - Read 93 rows from 2024/12/06/stocks.csv
2025-11-25 04:09:04,522 - INFO - Read 91 rows from 2024/12/24/stocks.csv
2025-11-25 04:09:04,522 - INFO - Read 93 rows from 2024/12/23/stocks.csv
2025-11-25 04:09:04,523 - INFO - Read 93 rows from 2024/12/12/stocks.csv
2025-11-25 04:09:04,523 - INFO - Read 93 rows from 2024/12/13/stocks.csv
2025-11-25 04:09:04,524 - INFO - Read 1 rows from 2024/12/25/stocks.csv
2025-11-25 04:09:04,531 - INFO - Merged 3695 rows for stocks_raw
2025-11-25 04:09:05,034 - INFO - Validation complete for stocks_raw: valid=3695, invalid=0
2025-11-25 04:09:05,070 - INFO - Valid: 3695, Invalid: 0
2025-11-25 04:09:05,092 - INFO - Table stocks_raw created
2025-11-25 04:09:05,353 - INFO - Inserted 3695 rows into stocks_raw
2025-11-25 04:09:05,354 - INFO - Loaded 3695 rows to stocks_raw
2025-11-25 04:09:05,354 - INFO - Base table established with 3695 records
2025-11-25 04:09:05,354 - INFO - Found 93 unique tickers: 601336.SS, AAL, AAPL, ABBV, ACI, ADM, AIG, ALL, AMZN, ATT.L, AXP, BA, BAC, BBY, C, CAH, CAT, CHS.V, CHTR, CI, CMCSA, CNC, COF, COLA.WA, COP, COR, COST, CSCO, CVS, CVX, DAL, DE, DELL, DIS, DOW, ELV, EPD, ET, F, FDX, FMCC, FNMA, GE, GM, GOOGL, GS, HCA, HD, HUM.ST, IBM, INTC, JNJ, JPM, KR, LFG.AX, LMT, MCK, MET, META, MPC, MRK, MS, MSFT, NKE, NVDA, ORCL, PAGP, PEP, PFGC, PFIZER.NS, PG, PGR, PRU, PSX, RTX, SNEX, SNX, SYY, TGT, TILIX, TJX, TSLA, TSN, UAL, UNH, UPS, VLO, VZ, WFC, WKC, WMT, X1G.PA, XOM
2025-11-25 04:09:05,354 - INFO - 
============================================================
2025-11-25 04:09:05,354 - INFO - Processing DEPENDENT TABLES
2025-11-25 04:09:05,354 - INFO - Processing company_metadata
2025-11-25 04:09:05,355 - INFO - Read 93 rows from 2024/company_details.csv
2025-11-25 04:09:05,356 - INFO - Merged 93 rows for company_metadata
2025-11-25 04:09:05,361 - INFO - Validation complete for company_metadata: valid=93, invalid=0
2025-11-25 04:09:05,363 - INFO - Valid: 93, Invalid: 0
2025-11-25 04:09:05,365 - ERROR - Failed to load company_metadata: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rank INT PRIMARY KEY,
            company VARCHAR(255) NOT NULL UNIQUE,
        ' at line 2
2025-11-25 04:09:05,365 - ERROR - Error type: ProgrammingError
2025-11-25 04:09:05,365 - ERROR - Error details: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rank INT PRIMARY KEY,
            company VARCHAR(255) NOT NULL UNIQUE,
        ' at line 2
2025-11-25 04:09:05,365 - ERROR - Failed to load company_metadata: 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'rank INT PRIMARY KEY,
            company VARCHAR(255) NOT NULL UNIQUE,
        ' at line 2
2025-11-25 04:09:05,365 - INFO - company_metadata processed and linked to stocks_raw
2025-11-25 04:09:05,365 - INFO - 
============================================================
2025-11-25 04:09:05,365 - INFO - Processing INDEPENDENT TABLES
2025-11-25 04:09:05,365 - INFO - Processing exchange_rates
2025-11-25 04:09:05,366 - INFO - Read 251 rows from 2024.csv
2025-11-25 04:09:05,366 - INFO - Merged 251 rows for exchange_rates
2025-11-25 04:09:05,409 - INFO - Validation complete for exchange_rates: valid=251, invalid=0
2025-11-25 04:09:05,412 - INFO - Valid: 251, Invalid: 0
2025-11-25 04:09:05,414 - INFO - Table exchange_rates created
2025-11-25 04:09:05,432 - INFO - Inserted 251 rows into exchange_rates
2025-11-25 04:09:05,432 - INFO - Loaded 251 rows to exchange_rates
2025-11-25 04:09:05,432 - INFO - exchange_rates processed
2025-11-25 04:09:05,432 - INFO - Processing macro_raw
2025-11-25 04:09:05,433 - INFO - Read 4 rows from 2024.csv
2025-11-25 04:09:05,433 - INFO - Merged 4 rows for macro_raw
2025-11-25 04:09:05,434 - INFO - Validation complete for macro_raw: valid=4, invalid=0
2025-11-25 04:09:05,435 - INFO - Valid: 4, Invalid: 0
2025-11-25 04:09:05,437 - INFO - Table macro_raw created
2025-11-25 04:09:05,440 - INFO - Inserted 4 rows into macro_raw
2025-11-25 04:09:05,440 - INFO - Loaded 4 rows to macro_raw
2025-11-25 04:09:05,440 - INFO - macro_raw processed
2025-11-25 04:09:05,440 - INFO - 
============================================================
2025-11-25 04:09:05,440 - INFO - Processing SENTIMENT DATA
2025-11-25 04:09:05,440 - INFO - Processing sentiment
2025-11-25 04:09:05,440 - WARNING - No historical data available for sentiment - only live data exists
2025-11-25 04:09:05,440 - WARNING - sentiment not available
2025-11-25 04:09:05,440 - INFO - 
============================================================
2025-11-25 04:09:05,440 - INFO - KPI CALCULATIONS AND FACT TABLE GENERATION
2025-11-25 04:09:05,440 - INFO - ============================================================
2025-11-25 04:09:05,440 - INFO - Starting KPI calculations
2025-11-25 04:09:05,442 - INFO - Loaded stocks_raw: 3695 rows
2025-11-25 04:09:05,442 - INFO - Loaded macro_raw: 4 rows
2025-11-25 04:09:05,442 - INFO - Loaded company_metadata: 93 rows
2025-11-25 04:09:05,442 - INFO - Loaded exchange_rates: 251 rows
2025-11-25 04:09:05,444 - INFO - Calculating stock_facts metrics...
2025-11-25 04:09:05,485 - INFO - Stock facts calculated: 3695 rows
2025-11-25 04:09:05,485 - INFO - Calculating macro_facts metrics...
2025-11-25 04:09:05,490 - INFO - Macro facts calculated: 4 rows
2025-11-25 04:09:05,491 - INFO - Creating sector_lookup...
2025-11-25 04:09:05,491 - INFO - Sector lookup created: 36 sectors
2025-11-25 04:09:05,491 - INFO - Calculating analytics_summary metrics...
2025-11-25 04:09:05,653 - INFO - Analytics summary calculated: 93 rows
2025-11-25 04:09:05,654 - INFO - 
============================================================
2025-11-25 04:09:05,654 - INFO - KPI calculations completed successfully
2025-11-25 04:09:05,654 - INFO - Generated files: stock_facts.csv, macro_facts.csv, sector_lookup.csv, analytics_summary.csv, pipeline_logs.csv
2025-11-25 04:09:05,654 - INFO - KPI calculations completed successfully
2025-11-25 04:09:05,667 - INFO - Table stock_facts created
2025-11-25 04:09:06,061 - INFO - Inserted 3695 rows into stock_facts
2025-11-25 04:09:06,062 - INFO - Loaded stock_facts to database
2025-11-25 04:09:06,064 - INFO - Table macro_facts created
2025-11-25 04:09:06,067 - INFO - Inserted 4 rows into macro_facts
2025-11-25 04:09:06,067 - INFO - Loaded macro_facts to database
2025-11-25 04:09:06,069 - INFO - Table sector_lookup created
2025-11-25 04:09:06,074 - INFO - Inserted 36 rows into sector_lookup
2025-11-25 04:09:06,074 - INFO - Loaded sector_lookup to database
2025-11-25 04:09:06,076 - INFO - Table analytics_summary created
2025-11-25 04:09:06,090 - INFO - Inserted 93 rows into analytics_summary
2025-11-25 04:09:06,090 - INFO - Loaded analytics_summary to database
2025-11-25 04:09:06,090 - INFO - 
============================================================
2025-11-25 04:09:06,090 - INFO -  ANALYTICS LAYER
2025-11-25 04:09:06,091 - INFO - 
================================================================================
2025-11-25 04:09:06,091 - INFO - REPORT GENERATION STARTED
2025-11-25 04:09:06,091 - INFO - ================================================================================
2025-11-25 04:09:06,091 - INFO - ================================================================================
2025-11-25 04:09:06,091 - INFO - Created directory: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports
2025-11-25 04:09:06,091 - INFO - 
============================================================
2025-11-25 04:09:06,091 - INFO - Generating Report 1: Annual Market Intelligence Report
2025-11-25 04:09:06,091 - INFO - ============================================================
2025-11-25 04:09:06,099 - INFO - Fetched 1 rows for yearly performance
2025-11-25 04:09:06,100 - ERROR - Failed to generate annual market intelligence report: 1146 (42S02): Table 'stocks_new.company_metadata' doesn't exist
2025-11-25 04:09:06,102 - ERROR - Traceback (most recent call last):
  File "/Users/shalinitata/Desktop/stocks/stocks/lib/python3.13/site-packages/mysql/connector/connection_cext.py", line 772, in cmd_query
    self._cmysql.query(
    ~~~~~~~~~~~~~~~~~~^
        query,
        ^^^^^^
    ...<3 lines>...
        query_attrs=self.query_attrs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
_mysql_connector.MySQLInterfaceError: Table 'stocks_new.company_metadata' doesn't exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/shalinitata/Desktop/stocks/report.py", line 140, in annual_market_intelligence_report
    cursor.execute(query_company_performance)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/shalinitata/Desktop/stocks/stocks/lib/python3.13/site-packages/mysql/connector/cursor_cext.py", line 353, in execute
    self._connection.cmd_query(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._stmt_partition["mappable_stmt"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        raw_as_string=self._raw_as_string,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/shalinitata/Desktop/stocks/stocks/lib/python3.13/site-packages/mysql/connector/opentelemetry/context_propagation.py", line 97, in wrapper
    return method(cnx, *args, **kwargs)
  File "/Users/shalinitata/Desktop/stocks/stocks/lib/python3.13/site-packages/mysql/connector/connection_cext.py", line 781, in cmd_query
    raise get_mysql_exception(
        err.errno, msg=err.msg, sqlstate=err.sqlstate
    ) from err
mysql.connector.errors.ProgrammingError: 1146 (42S02): Table 'stocks_new.company_metadata' doesn't exist

2025-11-25 04:09:06,103 - INFO - 
============================================================
2025-11-25 04:09:06,103 - INFO - Generating Report 2: Sector Stability & Volatility Report
2025-11-25 04:09:06,103 - INFO - ============================================================
2025-11-25 04:09:06,105 - INFO - Fetched 36 rows for sector metrics
2025-11-25 04:09:06,106 - INFO - Saved intermediate CSV: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report2_sector_stability.csv
2025-11-25 04:09:06,178 - INFO - Saved Excel: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report2_sector_stability_20251125_040906.xlsx
2025-11-25 04:09:06,181 - INFO - Report 2 completed: {'csv': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report2_sector_stability.csv', 'excel': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report2_sector_stability_20251125_040906.xlsx', 'pdf': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report2_sector_stability_20251125_040906.pdf'}
2025-11-25 04:09:06,181 - INFO - 
============================================================
2025-11-25 04:09:06,181 - INFO - Generating Report 3: Cross-Market Analysis Report
2025-11-25 04:09:06,181 - INFO - ============================================================
2025-11-25 04:09:06,186 - INFO - Fetched 1 rows for yearly currency data
2025-11-25 04:09:06,187 - INFO - Fetched 20 rows for company currency data
2025-11-25 04:09:06,188 - INFO - Saved intermediate CSV: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report3_currency_yearly.csv
2025-11-25 04:09:06,188 - INFO - Saved intermediate CSV: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report3_company_currency.csv
2025-11-25 04:09:06,190 - INFO - Report 3 completed: {'csv': ['/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report3_currency_yearly.csv', '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report3_company_currency.csv'], 'pdf': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report3_cross_market_20251125_040906.pdf'}
2025-11-25 04:09:06,190 - INFO - 
============================================================
2025-11-25 04:09:06,190 - INFO - Generating Report 4: Forecasting & Prediction Summary
2025-11-25 04:09:06,190 - INFO - ============================================================
2025-11-25 04:09:06,192 - INFO - Fetched 1 rows for quarterly trends
2025-11-25 04:09:06,193 - INFO - Fetched 36 rows for sector forecast
2025-11-25 04:09:06,194 - INFO - Saved intermediate CSV: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report4_quarterly_trends.csv
2025-11-25 04:09:06,194 - INFO - Saved intermediate CSV: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report4_sector_forecast.csv
2025-11-25 04:09:06,196 - INFO - Saved PDF: /Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report4_forecasting_20251125_040906.pdf
2025-11-25 04:09:06,196 - INFO - Report 4 completed: {'csv': ['/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report4_quarterly_trends.csv', '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report4_sector_forecast.csv'], 'pdf': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report4_forecasting_20251125_040906.pdf'}
2025-11-25 04:09:06,196 - INFO - 
================================================================================
2025-11-25 04:09:06,196 - INFO - REPORT GENERATION COMPLETED SUCCESSFULLY
2025-11-25 04:09:06,196 - INFO - ================================================================================
2025-11-25 04:09:06,196 - INFO - 
Generated Reports:
2025-11-25 04:09:06,196 - INFO - 1. Annual Market Intelligence Report
2025-11-25 04:09:06,196 - INFO - 2. Sector Stability & Volatility Report
2025-11-25 04:09:06,196 - INFO - 3. Cross-Market Analysis Report
2025-11-25 04:09:06,196 - INFO - 4. Forecasting & Prediction Summary
2025-11-25 04:09:06,196 - INFO - ================================================================================
2025-11-25 04:09:06,196 - INFO - Report generation completed successfully
2025-11-25 04:09:06,196 - INFO -   - sector_stability_volatility: {'csv': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report2_sector_stability.csv', 'excel': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report2_sector_stability_20251125_040906.xlsx', 'pdf': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report2_sector_stability_20251125_040906.pdf'}
2025-11-25 04:09:06,196 - INFO -   - cross_market_analysis: {'csv': ['/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report3_currency_yearly.csv', '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report3_company_currency.csv'], 'pdf': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report3_cross_market_20251125_040906.pdf'}
2025-11-25 04:09:06,196 - INFO -   - forecasting_prediction: {'csv': ['/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report4_quarterly_trends.csv', '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/report4_sector_forecast.csv'], 'pdf': '/Users/shalinitata/Desktop/stocks/Execution/2025/11/25/2025:11:25_04:09:04/reports/report4_forecasting_20251125_040906.pdf'}
